<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Offline Test</title>
    <link rel="stylesheet" href="../../shared/common.css">
    <link rel="stylesheet" href="login.css">
    
    <style>
        /* Test specific styles */
        .test-overlay {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 1rem;
            border-radius: 10px;
            font-size: 0.8rem;
            z-index: 10000;
            max-width: 300px;
        }
        
        .test-overlay h4 {
            margin: 0 0 0.5rem 0;
            color: #ff5722;
        }
        
        .test-changes {
            background: rgba(255, 87, 34, 0.1);
            border: 1px solid rgba(255, 87, 34, 0.3);
            border-radius: 10px;
            padding: 1rem;
            margin: 1rem 0;
            color: white;
        }
        
        .change-item {
            margin: 0.5rem 0;
            padding: 0.3rem 0;
            border-left: 3px solid #ff5722;
            padding-left: 0.5rem;
        }
        
        .demo-highlight {
            animation: highlight 2s ease-in-out infinite;
        }
        
        @keyframes highlight {
            0%, 100% { background: rgba(255, 87, 34, 0.1); }
            50% { background: rgba(255, 87, 34, 0.3); }
        }
    </style>
</head>
<body class="no-navigation no-breadcrumb">
    <!-- Test info overlay -->
    <div class="test-overlay">
        <h4>🧪 OFFLINE TEST MODE</h4>
        <p><strong>Změny k testování:</strong></p>
        <ul style="font-size: 0.7rem; margin: 0.5rem 0; padding-left: 1rem;">
            <li>Demo účty: delší hesla</li>
            <li>Podmínky: GDPR modal</li>
            <li>Reset: 2 varianty</li>
            <li>Email: povinný</li>
            <li>Redirect: na dashboard</li>
        </ul>
    </div>

    <div class="auth-container">
        <div class="auth-header">
            <h1>🎯 Quiz App</h1>
            <p>Modulární verze s vylepšenou architekturou</p>
            <a href="../../index.html" class="back-link">← Zpět na hlavní stránku</a>
        </div>

        <div class="test-changes">
            <h3>🔧 Aktuálně testované změny:</h3>
            <div class="change-item">✅ <strong>Demo účty:</strong> Bez admin, silná hesla (8+ znaků)</div>
            <div class="change-item">📋 <strong>Podmínky:</strong> GDPR modal s plným obsahem</div>
            <div class="change-item">🔑 <strong>Reset hesla:</strong> 2 varianty (zapomenutí vs změna)</div>
            <div class="change-item">📧 <strong>Email povinný:</strong> Pro reset hesla</div>
            <div class="change-item">🏠 <strong>Redirect:</strong> Po login na dashboard index.html</div>
        </div>

        <div class="auth-tabs">
            <button class="auth-tab active" data-tab="login">Přihlášení</button>
            <button class="auth-tab" data-tab="register">Registrace</button>
            <button class="auth-tab" data-tab="reset">Reset hesla</button>
        </div>

        <!-- LOGIN FORM -->
        <div id="login-form" class="auth-form active">
            <div class="card">
                <div class="card-header">
                    <h2>🔐 Přihlášení</h2>
                    <p class="card-subtitle">Přihlaste se ke svému účtu</p>
                </div>

                <form id="loginForm">
                    <div class="form-group">
                        <label for="loginUsername" class="form-label">Uživatelské jméno</label>
                        <input 
                            type="text" 
                            id="loginUsername" 
                            class="form-input" 
                            required 
                            minlength="3"
                            maxlength="20"
                            placeholder="Zadejte své uživatelské jméno"
                        >
                    </div>

                    <div class="form-group">
                        <label for="loginPassword" class="form-label">Heslo</label>
                        <input 
                            type="password" 
                            id="loginPassword" 
                            class="form-input" 
                            required 
                            minlength="6"
                            placeholder="Zadejte své heslo"
                        >
                    </div>

                    <button type="submit" class="btn btn-large" style="width: 100%">
                        Přihlásit se
                    </button>
                </form>

                <div class="auth-demo demo-highlight">
                    <h4>Demo účty pro testování:</h4>
                    <div class="demo-accounts">
                        <button class="btn btn-small btn-outline demo-btn" data-username="testuser" data-password="testpass123">
                            👤 Test User
                        </button>
                        <button class="btn btn-small btn-outline demo-btn" data-username="student" data-password="student2024">
                            🎓 Student
                        </button>
                        <button class="btn btn-small btn-outline demo-btn" data-username="demo" data-password="demouser2024">
                            🎯 Demo
                        </button>
                    </div>
                    <div style="background: rgba(76, 175, 80, 0.1); padding: 0.5rem; border-radius: 5px; margin-top: 0.5rem;">
                        <small>✅ <strong>Změna:</strong> Delší hesla (8-13 znaků), žádný admin účet</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- REGISTER FORM -->
        <div id="register-form" class="auth-form">
            <div class="card">
                <div class="card-header">
                    <h2>📝 Registrace</h2>
                    <p class="card-subtitle">Vytvořte si nový účet</p>
                </div>

                <form id="registerForm">
                    <div class="form-group">
                        <label for="registerUsername" class="form-label">Uživatelské jméno</label>
                        <input 
                            type="text" 
                            id="registerUsername" 
                            class="form-input" 
                            required 
                            minlength="3"
                            maxlength="20"
                            pattern="[a-zA-Z0-9_]+"
                            placeholder="3-20 znaků, pouze písmena, číslice a podtržítka"
                        >
                        <small class="form-help">Pouze písmena, číslice a podtržítka</small>
                    </div>

                    <div class="form-group">
                        <label for="registerEmail" class="form-label">Email <span style="color: #ff5722;">*</span></label>
                        <input 
                            type="email" 
                            id="registerEmail" 
                            class="form-input" 
                            required
                            placeholder="vas@email.com"
                        >
                        <small class="form-help" style="color: #ff5722;">
                            ✅ <strong>Změna:</strong> Email je nyní povinný pro reset hesla
                        </small>
                    </div>

                    <div class="form-group">
                        <label for="registerPassword" class="form-label">Heslo</label>
                        <input 
                            type="password" 
                            id="registerPassword" 
                            class="form-input" 
                            required 
                            minlength="6"
                            placeholder="Alespoň 6 znaků"
                        >
                    </div>

                    <div class="form-group">
                        <label for="registerPasswordConfirm" class="form-label">Potvrzení hesla</label>
                        <input 
                            type="password" 
                            id="registerPasswordConfirm" 
                            class="form-input" 
                            required 
                            placeholder="Zadejte heslo znovu"
                        >
                    </div>

                    <div class="form-group demo-highlight">
                        <label class="checkbox-label">
                            <input type="checkbox" id="agreeTerms" required> 
                            Souhlasím s <a href="#" data-navigate="terms" style="color: #ff5722;">podmínkami použití</a>
                        </label>
                        <div style="background: rgba(76, 175, 80, 0.1); padding: 0.5rem; border-radius: 5px; margin-top: 0.5rem;">
                            <small>✅ <strong>Změna:</strong> Kliknutím otevřete GDPR compliant podmínky</small>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-large" style="width: 100%">
                        Zaregistrovat se
                    </button>
                </form>
            </div>
        </div>

        <!-- RESET FORM -->
        <div id="reset-form" class="auth-form">
            <div class="card">
                <div class="card-header">
                    <h2>🔑 Reset hesla</h2>
                    <p class="card-subtitle">Obnovte si zapomenuté heslo nebo ho změňte</p>
                </div>

                <!-- Reset Type Selection -->
                <div class="reset-type-selection demo-highlight">
                    <h4>Vyberte typ reset hesla:</h4>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="resetType" value="forgot" checked>
                            <span class="radio-custom"></span>
                            🤔 Zapomněl jsem heslo
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="resetType" value="change">
                            <span class="radio-custom"></span>
                            🔄 Chci změnit heslo
                        </label>
                    </div>
                    <div style="background: rgba(76, 175, 80, 0.1); padding: 0.5rem; border-radius: 5px; margin-top: 0.5rem;">
                        <small>✅ <strong>Změna:</strong> 2 varianty - zapomenuté vs změna hesla</small>
                    </div>
                </div>

                <!-- Forgot Password Form -->
                <div id="forgot-password-form">
                    <form id="forgotPasswordForm">
                        <div class="form-group">
                            <label for="resetEmail" class="form-label">Email nebo uživatelské jméno</label>
                            <input 
                                type="text" 
                                id="resetEmail" 
                                class="form-input" 
                                required 
                                placeholder="Zadejte email nebo uživatelské jméno"
                            >
                        </div>

                        <button type="submit" class="btn btn-large" style="width: 100%">
                            Odeslat reset link
                        </button>
                    </form>

                    <div class="notification notification-info">
                        <strong>Info:</strong> Reset link bude odeslán na váš email.
                    </div>
                </div>

                <!-- Change Password Form -->
                <div id="change-password-form" style="display: none;">
                    <form id="changePasswordForm">
                        <div class="form-group">
                            <label for="currentUsername" class="form-label">Uživatelské jméno</label>
                            <input 
                                type="text" 
                                id="currentUsername" 
                                class="form-input" 
                                required 
                                placeholder="Vaše uživatelské jméno"
                            >
                        </div>

                        <div class="form-group">
                            <label for="currentPassword" class="form-label">Současné heslo</label>
                            <input 
                                type="password" 
                                id="currentPassword" 
                                class="form-input" 
                                required 
                                placeholder="Zadejte současné heslo"
                            >
                        </div>

                        <div class="form-group">
                            <label for="newPassword" class="form-label">Nové heslo</label>
                            <input 
                                type="password" 
                                id="newPassword" 
                                class="form-input" 
                                required 
                                minlength="6"
                                placeholder="Alespoň 6 znaků"
                            >
                        </div>

                        <div class="form-group">
                            <label for="newPasswordConfirm" class="form-label">Potvrzení nového hesla</label>
                            <input 
                                type="password" 
                                id="newPasswordConfirm" 
                                class="form-input" 
                                required 
                                placeholder="Zadejte nové heslo znovu"
                            >
                        </div>

                        <button type="submit" class="btn btn-large" style="width: 100%">
                            Změnit heslo
                        </button>
                    </form>

                    <div class="notification notification-warning">
                        <strong>Pozor:</strong> Po změně hesla budete odhlášeni ze všech zařízení.
                    </div>
                </div>
            </div>
        </div>

        <!-- TERMS OF SERVICE MODAL -->
        <div id="termsModal" class="modal-overlay" style="display: none;">
            <div class="modal demo-highlight">
                <div class="modal-header">
                    <h3>📋 Podmínky použití a ochrana osobních údajů</h3>
                    <button class="modal-close" id="closeTermsModal">&times;</button>
                </div>
                <div class="modal-content">
                    <div class="terms-content">
                        <div style="background: rgba(76, 175, 80, 0.1); padding: 1rem; border-radius: 10px; margin-bottom: 1rem;">
                            <p style="margin: 0; font-weight: 600; color: #4caf50;">✅ Změna: Plně GDPR compliant podmínky</p>
                        </div>
                        
                        <h4>🎯 O aplikaci</h4>
                        <p>Toto je <strong>testovací verze</strong> modulární quizové aplikace vytvořené pro vzdělávací a demonstrační účely. Aplikace není dokončená a může obsahovat chyby nebo nedokončené funkcionality.</p>
                        
                        <h4>🔒 Ochrana osobních údajů (GDPR)</h4>
                        <ul>
                            <li><strong>Zpracování dat:</strong> Zpracováváme pouze údaje nezbytné pro fungování aplikace</li>
                            <li><strong>Bezpečnost:</strong> Hesla jsou hashována pomocí moderních kryptografických metod</li>
                            <li><strong>Sdílení:</strong> Vaše data nesdílíme s třetími stranami</li>
                            <li><strong>Práva:</strong> Máte právo na přístup, opravu nebo smazání svých dat</li>
                        </ul>
                        
                        <h4>⚠️ Testovací verze - omezení</h4>
                        <ul>
                            <li>Aplikace je ve vývoji a může být kdykoli změněna</li>
                            <li>Data mohou být při aktualizacích ztracena</li>
                            <li>Neručíme za spolehlivost či dostupnost služby</li>
                        </ul>
                        
                        <div class="terms-footer">
                            <p><strong>Poslední aktualizace:</strong> 7. srpna 2025</p>
                            <p><em>Registrací souhlasíte s těmito podmínkami a se zpracováním osobních údajů v souladu s GDPR.</em></p>
                        </div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-outline" id="declineTerms">Nesouhlasím</button>
                    <button class="btn btn-primary" id="acceptTerms">Souhlasím s podmínkami</button>
                </div>
            </div>
        </div>

        <!-- STATUS SECTION -->
        <div class="auth-status">
            <div class="server-status demo-highlight">
                <span class="status-indicator">🧪 OFFLINE TEST MODE</span>
                <div style="background: rgba(255, 87, 34, 0.1); padding: 0.5rem; border-radius: 5px; margin-top: 0.5rem;">
                    <small>Po úspěšném login: redirect na <strong>index.html</strong> (dashboard)</small>
                </div>
            </div>
        </div>
    </div>

    <!-- Demo JavaScript pro testování -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🧪 OFFLINE LOGIN TEST MODE');
            
            // Demo tab switching
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.addEventListener('click', (e) => {
                    document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
                    
                    e.target.classList.add('active');
                    document.getElementById(e.target.dataset.tab + '-form').classList.add('active');
                });
            });
            
            // Demo reset type switching
            document.querySelectorAll('input[name="resetType"]').forEach(radio => {
                radio.addEventListener('change', (e) => {
                    if (e.target.value === 'forgot') {
                        document.getElementById('forgot-password-form').style.display = 'block';
                        document.getElementById('change-password-form').style.display = 'none';
                    } else {
                        document.getElementById('forgot-password-form').style.display = 'none';
                        document.getElementById('change-password-form').style.display = 'block';
                    }
                });
            });
            
            // Demo credentials buttons
            document.querySelectorAll('.demo-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const username = e.target.dataset.username;
                    const password = e.target.dataset.password;
                    
                    document.getElementById('loginUsername').value = username;
                    document.getElementById('loginPassword').value = password;
                    
                    console.log(`Demo credentials filled: ${username} / ${password}`);
                });
            });
            
            // Terms modal
            const termsLink = document.querySelector('[data-navigate="terms"]');
            const termsModal = document.getElementById('termsModal');
            const closeModalBtn = document.getElementById('closeTermsModal');
            const acceptBtn = document.getElementById('acceptTerms');
            const declineBtn = document.getElementById('declineTerms');
            const agreeCheckbox = document.getElementById('agreeTerms');
            
            termsLink?.addEventListener('click', (e) => {
                e.preventDefault();
                termsModal.style.display = 'flex';
            });
            
            closeModalBtn?.addEventListener('click', () => {
                termsModal.style.display = 'none';
            });
            
            acceptBtn?.addEventListener('click', () => {
                agreeCheckbox.checked = true;
                termsModal.style.display = 'none';
                alert('✅ Souhlasili jste s podmínkami použití');
            });
            
            declineBtn?.addEventListener('click', () => {
                agreeCheckbox.checked = false;
                termsModal.style.display = 'none';
                alert('⚠️ Pro registraci je nutný souhlas s podmínkami');
            });
            
            // Mock form submissions
            document.getElementById('loginForm')?.addEventListener('submit', (e) => {
                e.preventDefault();
                alert('✅ DEMO: Po úspěšném přihlášení → redirect na index.html (dashboard)');
            });
            
            document.getElementById('registerForm')?.addEventListener('submit', (e) => {
                e.preventDefault();
                alert('✅ DEMO: Email je nyní povinný pro registraci');
            });
            
            document.getElementById('forgotPasswordForm')?.addEventListener('submit', (e) => {
                e.preventDefault();
                alert('✅ DEMO: Reset link byl odeslán na email');
            });
            
            document.getElementById('changePasswordForm')?.addEventListener('submit', (e) => {
                e.preventDefault();
                alert('✅ DEMO: Heslo bylo změněno');
            });
            
            console.log('📋 Test changes loaded:');
            console.log('1. Demo accounts: stronger passwords, no admin');
            console.log('2. Terms: GDPR modal');
            console.log('3. Reset: 2 variants (forgot/change)');
            console.log('4. Email: required for registration');
            console.log('5. Redirect: to dashboard after login');
        });
    </script>
</body>
</html>
