# 🚀 DEPLOYMENT GUIDE - Kompletní nasazení modulární Quiz App

## 📋 Přehled nasazení

**Frontend:** GitHub Pages (zdarma)  
**Backend:** Render.com (zdarma tier)  
**Database:** PostgreSQL na Render.com  
**AI:** Monica AI API integrace  

---

## 🎯 KROK 1: Příprava GitHub Repository

### 1.1 Vytvoření repository
```bash
# Vytvoření nového repository na GitHub
# Název např.: quiz-modular-app

# Lokální git setup
git init
git add .
git commit -m "Initial commit - Modular Quiz App"
git branch -M main
git remote add origin https://github.com/YOUR-USERNAME/quiz-modular-app.git
git push -u origin main
```

### 1.2 Organizace souborů
```
quiz-modular-app/
├── frontend/           # Pro GitHub Pages
│   ├── index.html
│   ├── pages/         # Všechny moduly
│   └── shared/        # Společné komponenty
├── backend/           # Pro Render.com
│   ├── app.py
│   ├── requirements.txt
│   ├── render.yaml
│   └── ...
└── docs/             # Dokumentace
```

---

## 🌐 KROK 2: Nasazení Frontendu (GitHub Pages)

### 2.1 Příprava struktury
```bash
# Zkopírování našich modulů do frontend/
cp -r modular-app/frontend/* frontend/

# Hlavní index.html pro GitHub Pages
cp modular-app/frontend/index.html index.html
```

### 2.2 Aktualizace cest v HTML
V `index.html` a všech modulech upravte cesty:
```html
<!-- Z relativních cest -->
<link href="./shared/common.css" rel="stylesheet">

<!-- Na absolutní cesty pro GitHub Pages -->
<link href="/quiz-modular-app/frontend/shared/common.css" rel="stylesheet">
```

### 2.3 Aktivace GitHub Pages
1. Jděte na GitHub repository
2. Settings → Pages
3. Source: Deploy from a branch
4. Branch: main / (root)
5. Save

**URL bude:** `https://YOUR-USERNAME.github.io/quiz-modular-app`

---

## 🚀 KROK 3: Nasazení Backendu (Render.com)

### 3.1 Registrace na Render.com
1. Jděte na [render.com](https://render.com)
2. Zaregistrujte se pomocí GitHub účtu
3. Propojte GitHub repository

### 3.2 Vytvoření Web Service
1. **New Web Service**
2. **Connect repository:** `quiz-modular-app`
3. **Konfigurace:**
   ```
   Name: quiz-modular-backend
   Region: Frankfurt (FRA)
   Branch: main
   Root Directory: backend
   Runtime: Python 3
   Build Command: pip install -r requirements.txt
   Start Command: gunicorn app:app --bind 0.0.0.0:$PORT --workers 4
   ```

### 3.3 Environment Variables
V Render.com nastavte:
```
FLASK_ENV=production
SECRET_KEY=[auto-generated by Render]
CORS_ORIGINS=https://YOUR-USERNAME.github.io
MONICA_API_KEY=your-monica-api-key-here
```

### 3.4 PostgreSQL Database
1. **New PostgreSQL Database**
2. **Konfigurace:**
   ```
   Name: quiz-modular-db
   Database Name: quiz_modular
   User: quiz_user
   Region: Frankfurt (FRA)
   ```
3. **Propojení:** Render automaticky nastaví `DATABASE_URL`

---

## 🔑 KROK 4: Monica AI Setup

### 4.1 Získání API klíče
1. Jděte na [Monica AI](https://monica.im)
2. Zaregistrujte se
3. API → Create API Key
4. Zkopírujte klíč

### 4.2 Nastavení v Render.com
```
MONICA_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxx
```

---

## 🔧 KROK 5: Propojení Frontend ↔ Backend

### 5.1 Aktualizace API URL
V `frontend/shared/api-client.js`:
```javascript
detectBackendURL() {
    const hostname = window.location.hostname;
    
    if (hostname === 'localhost' || hostname === '127.0.0.1') {
        return 'http://localhost:5000';  // Development
    } else {
        return 'https://quiz-modular-backend.onrender.com';  // Production
    }
}
```

### 5.2 CORS konfigurace
Backend automaticky povolí požadavky z:
- `https://YOUR-USERNAME.github.io`
- `http://localhost:3000` (development)

---

## ✅ KROK 6: Testování nasazení

### 6.1 Backend test
```bash
# Lokální test backendu
cd backend
python test_backend.py

# Test produkčního backendu
python test_backend.py quiz-modular-backend.onrender.com
```

### 6.2 Frontend test
1. Otevřete `https://YOUR-USERNAME.github.io/quiz-modular-app`
2. Otestujte:
   - ✅ Registrace/přihlášení
   - ✅ Quiz moduly
   - ✅ Battle mód
   - ✅ Ústní zkoušky
   - ✅ Admin panel
   - ✅ Nastavení

### 6.3 API Health Check
```bash
curl https://quiz-modular-backend.onrender.com/api/health
```

**Očekávaný výstup:**
```json
{
  "status": "healthy",
  "database": "connected",
  "monica_ai": "enabled",
  "timestamp": "2024-01-01T12:00:00Z",
  "version": "2.0.0-modular"
}
```

---

## 📊 KROK 7: Monitoring & Údržba

### 7.1 Render.com Dashboard
- **Logs:** Real-time server logs
- **Metrics:** CPU, memory, response times
- **Database:** Connections, queries, storage

### 7.2 Automatic Health Checks
Render automaticky monitoruje:
- `/api/health` endpoint
- HTTP response codes
- Response times

### 7.3 Database Backup
Render automaticky zálohuje PostgreSQL databázi:
- Denní automatic backups
- Point-in-time recovery
- Download backups možnost

---

## 🛠️ KROK 8: Běžné problémy a řešení

### 8.1 CORS chyby
**Problem:** `Access to fetch at 'https://...' from origin 'https://...' has been blocked by CORS policy`

**Řešení:**
1. Zkontrolujte `CORS_ORIGINS` v Render environment
2. Ujistěte se, že URL je přesně stejné jako ve frontendu

### 8.2 Database connection errors
**Problem:** `Connection to database failed`

**Řešení:**
1. Zkontrolujte PostgreSQL status v Render
2. Ověřte `DATABASE_URL` environment variable
3. Restartujte web service

### 8.3 Monica AI errors
**Problem:** `Monica AI request failed`

**Řešení:**
1. Ověřte `MONICA_API_KEY` validitu
2. Zkontrolujte credit balance
3. Testujte API klíč manuálně

### 8.4 Slow cold starts
**Problem:** První požadavek trvá dlouho

**Řešení:**
- Render free tier "spí" po neaktivitě
- Upgrade na paid tier pro instant wake
- Nebo použijte external monitoring service

---

## 🎯 KROK 9: Production Optimalizace

### 9.1 Performance
```yaml
# render.yaml optimalizace
services:
  - type: web
    plan: starter  # Upgrade z free
    numInstances: 2  # Multiple instances
    autoDeploy: false  # Manuální deploye
```

### 9.2 Database Optimizations
```python
# app.py optimalizace
app.config['SQLALCHEMY_ENGINE_OPTIONS'] = {
    'pool_size': 20,      # Více connections
    'max_overflow': 30,   # Burst capability
    'pool_pre_ping': True # Health checking
}
```

### 9.3 Frontend CDN
Přidejte CDN pro rychlejší loading:
```html
<!-- V hlavičce HTML -->
<link rel="dns-prefetch" href="//cdn.jsdelivr.net">
<link rel="preconnect" href="https://quiz-modular-backend.onrender.com">
```

---

## 🌟 KROK 10: Finální checklist

### ✅ Frontend (GitHub Pages)
- [ ] Repository nastaven a public
- [ ] GitHub Pages aktivován
- [ ] Všechny moduly fungují
- [ ] API client má správné URL
- [ ] Responsive design funguje

### ✅ Backend (Render.com)
- [ ] Web service běží
- [ ] PostgreSQL databáze připojena
- [ ] Environment variables nastaveny
- [ ] Health check vrací OK
- [ ] CORS správně nakonfigurován

### ✅ Integrace
- [ ] Frontend ↔ Backend komunikace
- [ ] Autentifikace funguje
- [ ] Monica AI odpovídá
- [ ] Real-time features aktivní
- [ ] Error handling robust

### ✅ Testing
- [ ] Všechny moduly otestovány
- [ ] Cross-browser kompatibilita
- [ ] Mobile responsiveness
- [ ] Performance optimalizace
- [ ] Security testing

---

## 🎉 Nasazení dokončeno!

**Frontend URL:** `https://YOUR-USERNAME.github.io/quiz-modular-app`  
**Backend API:** `https://quiz-modular-backend.onrender.com/api`  
**Health Check:** `https://quiz-modular-backend.onrender.com/api/health`  

### Default přístupy:
- **Admin:** `admin` / `admin123`
- **Student:** `student` / `student123`

### Další vývoj:
1. Monitoring & analytics setup
2. Custom domain konfigurace
3. Advanced security features
4. Performance optimalizace
5. A/B testing implementation

**Modulární Quiz App je nyní live v produkci! 🚀**
