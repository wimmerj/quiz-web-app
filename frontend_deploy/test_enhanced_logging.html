<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Enhanced Logging System</title>
    <link rel="stylesheet" href="quiz_styles.css">
</head>
<body>
    <div id="app">
        <nav class="menu-bar">
            <div class="menu-left">
                <h2>üîç Test Enhanced Logging System</h2>
            </div>
            <div class="menu-right">
                <button class="menu-item" onclick="toggleDebugPanel()">üìä Debug Panel</button>
            </div>
        </nav>

        <!-- Debug Panel -->
        <div class="debug-panel" id="debugPanel" style="display: block;">
            <div class="debug-header">
                <h3>Enhanced Debug Log</h3>
                <button type="button" onclick="toggleDebugPanel()" class="debug-toggle">Zav≈ô√≠t</button>
            </div>
            <div class="debug-content">
                <div class="debug-controls">
                    <div class="debug-buttons">
                        <button type="button" onclick="clearDebugLog()" class="debug-clear">Vymazat</button>
                        <button type="button" onclick="downloadDebugLog()" class="debug-download">üì• St√°hnout</button>
                    </div>
                    <div class="debug-stats">
                        <span id="debugStats">Log≈Ø: 0</span>
                    </div>
                </div>
                <div class="debug-log" id="debugLog">
                    <!-- Logs will be added here dynamically -->
                </div>
            </div>
        </div>

        <!-- Test Controls -->
        <div class="main-content" style="padding: 20px;">
            <div class="question-section">
                <h3>Test Enhanced Logging Functions</h3>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
                    
                    <!-- Basic Logging Tests -->
                    <div style="padding: 15px; background: rgba(0,0,0,0.2); border-radius: 8px;">
                        <h4>Basic Logging</h4>
                        <button onclick="testBasicLogs()" class="start-quiz-button" style="width: 100%; margin: 5px 0;">Test Basic Logs</button>
                        <button onclick="testErrorLogs()" style="background: #f44336; color: white; border: none; padding: 8px; border-radius: 4px; width: 100%; margin: 5px 0;">Test Error Logs</button>
                    </div>

                    <!-- Action Logging Tests -->
                    <div style="padding: 15px; background: rgba(0,0,0,0.2); border-radius: 8px;">
                        <h4>Action Logging</h4>
                        <button onclick="testUserActions()" style="background: #2196F3; color: white; border: none; padding: 8px; border-radius: 4px; width: 100%; margin: 5px 0;">Test User Actions</button>
                        <button onclick="testApiCalls()" style="background: #FF9800; color: white; border: none; padding: 8px; border-radius: 4px; width: 100%; margin: 5px 0;">Test API Calls</button>
                    </div>

                    <!-- Server Status Tests -->
                    <div style="padding: 15px; background: rgba(0,0,0,0.2); border-radius: 8px;">
                        <h4>Server Status</h4>
                        <button onclick="testServerStatus()" style="background: #9C27B0; color: white; border: none; padding: 8px; border-radius: 4px; width: 100%; margin: 5px 0;">Test Server Status</button>
                        <button onclick="simulateServerDown()" style="background: #795548; color: white; border: none; padding: 8px; border-radius: 4px; width: 100%; margin: 5px 0;">Simulate Server Down</button>
                    </div>

                    <!-- Performance Tests -->
                    <div style="padding: 15px; background: rgba(0,0,0,0.2); border-radius: 8px;">
                        <h4>Performance Tests</h4>
                        <button onclick="testPerformance()" style="background: #607D8B; color: white; border: none; padding: 8px; border-radius: 4px; width: 100%; margin: 5px 0;">Performance Test</button>
                        <button onclick="stressTest()" style="background: #E91E63; color: white; border: none; padding: 8px; border-radius: 4px; width: 100%; margin: 5px 0;">Stress Test</button>
                    </div>

                    <!-- Registration Flow Test -->
                    <div style="padding: 15px; background: rgba(0,0,0,0.2); border-radius: 8px;">
                        <h4>Registration Flow</h4>
                        <button onclick="testRegistrationFlow()" style="background: #4CAF50; color: white; border: none; padding: 8px; border-radius: 4px; width: 100%; margin: 5px 0;">Test Registration</button>
                        <button onclick="testLoginFlow()" style="background: #3F51B5; color: white; border: none; padding: 8px; border-radius: 4px; width: 100%; margin: 5px 0;">Test Login</button>
                    </div>

                    <!-- Download Test -->
                    <div style="padding: 15px; background: rgba(0,0,0,0.2); border-radius: 8px;">
                        <h4>Download System</h4>
                        <button onclick="populateTestData()" style="background: #FF5722; color: white; border: none; padding: 8px; border-radius: 4px; width: 100%; margin: 5px 0;">Populate Test Data</button>
                        <button onclick="downloadDebugLog()" style="background: #00BCD4; color: white; border: none; padding: 8px; border-radius: 4px; width: 100%; margin: 5px 0;">Download Logs</button>
                    </div>
                </div>

                <div style="margin-top: 20px; padding: 15px; background: rgba(76, 175, 80, 0.1); border-radius: 8px;">
                    <h4>üìä Test Results</h4>
                    <div id="testResults" style="font-family: monospace; font-size: 14px; color: #90EE90;">
                        Ready to run tests...
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Load Enhanced Logging System -->
    <script src="enhanced_logging.js"></script>
    
    <script>
        // Initialize Enhanced Logger
        let enhancedLogger = null;
        
        document.addEventListener('DOMContentLoaded', function() {
            if (window.EnhancedLogger) {
                enhancedLogger = new EnhancedLogger();
                window.enhancedLogger = enhancedLogger;
                enhancedLogger.log('Enhanced Logging Test Page Loaded', 'system');
                updateTestResults('‚úÖ Enhanced Logger initialized successfully');
            } else {
                updateTestResults('‚ùå Enhanced Logger not available');
            }
        });
        
        // Test Functions
        function testBasicLogs() {
            if (!enhancedLogger) return;
            
            enhancedLogger.log('This is an info message', 'info');
            enhancedLogger.log('This is a success message', 'success');
            enhancedLogger.log('This is a warning message', 'warning');
            enhancedLogger.log('This is a system message', 'system');
            
            updateTestResults('‚úÖ Basic logging test completed');
        }
        
        function testErrorLogs() {
            if (!enhancedLogger) return;
            
            enhancedLogger.log('This is an error message', 'error');
            enhancedLogger.log('Critical error occurred', 'error');
            enhancedLogger.log('Network timeout error', 'error');
            
            updateTestResults('‚úÖ Error logging test completed');
        }
        
        function testUserActions() {
            if (!enhancedLogger) return;
            
            enhancedLogger.logAction('button_click', { buttonId: 'startQuiz', timestamp: Date.now() });
            enhancedLogger.logAction('form_submit', { formType: 'registration', email: 'test@example.com' });
            enhancedLogger.logAction('navigation', { from: 'home', to: 'quiz' });
            enhancedLogger.logAction('user_login', { username: 'testuser', method: 'server' });
            
            updateTestResults('‚úÖ User action logging test completed');
        }
        
        function testApiCalls() {
            if (!enhancedLogger) return;
            
            enhancedLogger.logAction('api_call', { 
                url: '/api/auth/register', 
                method: 'POST',
                status: 201,
                duration: 235
            });
            
            enhancedLogger.logAction('api_call', { 
                url: '/api/auth/login', 
                method: 'POST',
                status: 200,
                duration: 156,
                response_size: 1024
            });
            
            enhancedLogger.logAction('api_call', { 
                url: '/api/users/profile', 
                method: 'GET',
                status: 500,
                error: 'Internal Server Error'
            });
            
            updateTestResults('‚úÖ API call logging test completed');
        }
        
        function testServerStatus() {
            if (!enhancedLogger) return;
            
            enhancedLogger.logServerStatus('online', 145);
            setTimeout(() => enhancedLogger.logServerStatus('checking', null), 1000);
            setTimeout(() => enhancedLogger.logServerStatus('online', 89), 2000);
            setTimeout(() => enhancedLogger.logServerStatus('unstable', 2340), 3000);
            
            updateTestResults('‚úÖ Server status logging test started (watch logs)');
        }
        
        function simulateServerDown() {
            if (!enhancedLogger) return;
            
            enhancedLogger.logServerStatus('checking', null);
            setTimeout(() => enhancedLogger.logServerStatus('offline', null), 1000);
            setTimeout(() => enhancedLogger.logServerStatus('checking', null), 3000);
            setTimeout(() => enhancedLogger.logServerStatus('online', 234), 5000);
            
            updateTestResults('‚úÖ Server down simulation started (watch logs)');
        }
        
        function testPerformance() {
            if (!enhancedLogger) return;
            
            const start = performance.now();
            
            // Simulate some work
            for (let i = 0; i < 1000; i++) {
                enhancedLogger.logAction('performance_test', { iteration: i, data: Math.random() });
            }
            
            const duration = performance.now() - start;
            enhancedLogger.log(`Performance test completed: ${duration.toFixed(2)}ms for 1000 logs`, 'info');
            
            updateTestResults(`‚úÖ Performance test: ${duration.toFixed(2)}ms for 1000 logs`);
        }
        
        function stressTest() {
            if (!enhancedLogger) return;
            
            let count = 0;
            const interval = setInterval(() => {
                enhancedLogger.log(`Stress test message #${count}`, count % 4 === 0 ? 'error' : 'info');
                enhancedLogger.logAction('stress_test', { count, timestamp: Date.now() });
                
                count++;
                if (count >= 50) {
                    clearInterval(interval);
                    updateTestResults('‚úÖ Stress test completed: 50 rapid logs');
                }
            }, 50);
            
            updateTestResults('üîÑ Stress test running...');
        }
        
        function testRegistrationFlow() {
            if (!enhancedLogger) return;
            
            // Simulate registration flow
            enhancedLogger.logAction('form_open', { formType: 'registration' });
            enhancedLogger.logAction('form_input', { field: 'username', value: 'test_user' });
            enhancedLogger.logAction('form_input', { field: 'email', value: 'test@example.com' });
            enhancedLogger.logAction('form_input', { field: 'password', value: '[HIDDEN]' });
            
            setTimeout(() => {
                enhancedLogger.logAction('api_call', { 
                    url: '/api/auth/register', 
                    method: 'POST',
                    status: 201
                });
                enhancedLogger.log('User registration successful', 'success');
            }, 1000);
            
            updateTestResults('‚úÖ Registration flow simulation started');
        }
        
        function testLoginFlow() {
            if (!enhancedLogger) return;
            
            // Simulate login flow
            enhancedLogger.logAction('form_open', { formType: 'login' });
            enhancedLogger.logAction('form_input', { field: 'username', value: 'test_user' });
            enhancedLogger.logAction('form_input', { field: 'password', value: '[HIDDEN]' });
            
            setTimeout(() => {
                enhancedLogger.logAction('api_call', { 
                    url: '/api/auth/login', 
                    method: 'POST',
                    status: 200,
                    response: { token: '[TOKEN]', user: 'test_user' }
                });
                enhancedLogger.log('User login successful', 'success');
            }, 800);
            
            updateTestResults('‚úÖ Login flow simulation started');
        }
        
        function populateTestData() {
            if (!enhancedLogger) return;
            
            // Create comprehensive test data
            const actions = [
                'button_click', 'form_submit', 'navigation', 'api_call', 
                'user_login', 'user_logout', 'quiz_start', 'quiz_answer'
            ];
            
            const logTypes = ['info', 'success', 'warning', 'error', 'system'];
            
            for (let i = 0; i < 25; i++) {
                const action = actions[Math.floor(Math.random() * actions.length)];
                const logType = logTypes[Math.floor(Math.random() * logTypes.length)];
                
                enhancedLogger.logAction(action, { 
                    testData: true, 
                    index: i, 
                    timestamp: Date.now(),
                    randomValue: Math.random()
                });
                
                enhancedLogger.log(`Test log message #${i} of type ${logType}`, logType);
            }
            
            // Add some server status changes
            enhancedLogger.logServerStatus('online', 123);
            enhancedLogger.logServerStatus('offline', null);
            enhancedLogger.logServerStatus('online', 456);
            
            updateTestResults('‚úÖ Test data populated: 25 actions + 25 logs + server status');
        }
        
        function updateTestResults(message) {
            const results = document.getElementById('testResults');
            if (results) {
                results.innerHTML += `<br>[${new Date().toLocaleTimeString()}] ${message}`;
                results.scrollTop = results.scrollHeight;
            }
        }
        
        // Global functions for debug panel
        function toggleDebugPanel() {
            const panel = document.getElementById('debugPanel');
            if (panel) {
                panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
            }
        }
        
        function clearDebugLog() {
            if (enhancedLogger) {
                enhancedLogger.clearLogs();
                updateTestResults('üóëÔ∏è Debug log cleared');
            }
        }
        
        function downloadDebugLog() {
            if (enhancedLogger) {
                enhancedLogger.downloadLogs();
                updateTestResults('üì• Debug log download initiated');
            }
        }
    </script>
</body>
</html>
